<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Vlasiator output data &mdash; Space Plasma Simulations with Vlasiator on LUMI Supercomputer  documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
      <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
      <link rel="stylesheet" type="text/css" href="../_static/sphinx_lesson.css?v=0c089442" />
      <link rel="stylesheet" type="text/css" href="../_static/sphinx_rtd_theme_ext_color_contrast.css?v=8e8ea19f" />
      <link rel="stylesheet" type="text/css" href="../_static/tabs.css?v=a5c4661c" />
      <link rel="stylesheet" type="text/css" href="../_static/overrides.css?v=0572569b" />

  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=187304be"></script>
        <script src="../_static/doctools.js?v=888ff710"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
        <script src="../_static/copybutton.js?v=f281be69"></script>
        <script src="../_static/minipres.js?v=a0d29692"></script>
        <script>let toggleHintShow = 'Click to show';</script>
        <script>let toggleHintHide = 'Click to hide';</script>
        <script>let toggleOpenOnPrint = 'true';</script>
        <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
        <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
        <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex/" />
    <link rel="search" title="Search" href="../search/" />
    <link rel="next" title="VisIt and VLSV bootcamp" href="../visit/" />
    <link rel="prev" title="How to configure Vlasiator for performance" href="../benchmarks_and_running/" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../" class="icon icon-home">
            Space Plasma Simulations with Vlasiator on LUMI Supercomputer
              <img src="../_static/ENCCS.jpg" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search/" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Prerequisites</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../introduction/">Introduction to Vlasiator</a></li>
<li class="toctree-l1"><a class="reference internal" href="../introduction/#rules-of-the-road">Rules of the Road</a></li>
<li class="toctree-l1"><a class="reference internal" href="../prepare_workspace/">Preparations for the workshop</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">The lessons</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installing-vlasiator/">Installing Vlasiator</a></li>
<li class="toctree-l1"><a class="reference internal" href="../benchmarks_and_running/">How to configure Vlasiator for performance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../benchmarks_and_running/#exercises">Exercises</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Vlasiator output data</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#why-we-teach-this-lesson">Why we teach this lesson</a></li>
<li class="toctree-l2"><a class="reference internal" href="#intended-learning-outcomes">Intended learning outcomes</a></li>
<li class="toctree-l2"><a class="reference internal" href="#three-kinds-of-data">Three kinds of data</a></li>
<li class="toctree-l2"><a class="reference internal" href="#the-vlsv-file-format">The VLSV file format</a></li>
<li class="toctree-l2"><a class="reference internal" href="#spatial-ordering-vlasov-vs-fsgrid-vs-velocity-space-variables">Spatial ordering: Vlasov- vs. FSGrid vs. Velocity space variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="#simulation-data-reducers">Simulation data reducers</a></li>
<li class="toctree-l2"><a class="reference internal" href="#vlsv-data-tools">VLSV data tools</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#vlsvextract">vlsvextract</a></li>
<li class="toctree-l3"><a class="reference internal" href="#vlsvdiff">vlsvdiff</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#other-output-files">Other output files</a></li>
<li class="toctree-l2"><a class="reference internal" href="#interesting-questions-you-might-get">Interesting questions you might get</a></li>
<li class="toctree-l2"><a class="reference internal" href="#typical-pitfalls">Typical pitfalls</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../visit/">VisIt and VLSV bootcamp</a></li>
<li class="toctree-l1"><a class="reference internal" href="../analysator/">Introduction to Analysator</a></li>
<li class="toctree-l1"><a class="reference internal" href="../analysator_exercises/">Analysator exercises</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../quick-reference/">Quick Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../vlasiator-cfg-reference/">Vlasiator config reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../analysator_supported/">Analysator supported data reducers and vlasiator variables</a></li>
<li class="toctree-l1"><a class="reference internal" href="../new_project/">New project from template</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../">Space Plasma Simulations with Vlasiator on LUMI Supercomputer</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Vlasiator output data</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/ENCCS/content/blob/main/content/vlasiator_outputs.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="vlasiator-output-data">
<h1>Vlasiator output data<a class="headerlink" href="#vlasiator-output-data" title="Link to this heading"></a></h1>
<section id="why-we-teach-this-lesson">
<h2>Why we teach this lesson<a class="headerlink" href="#why-we-teach-this-lesson" title="Link to this heading"></a></h2>
<p>Vlasiator has several grids and types of variables. Here we introduce them and go through which ones you might want to use for diagnostics and which one for sciencing.</p>
</section>
<section id="intended-learning-outcomes">
<h2>Intended learning outcomes<a class="headerlink" href="#intended-learning-outcomes" title="Link to this heading"></a></h2>
<p>You will be familiar with the outputs generated by Vlasiator and will understand which files and structures contain which information.</p>
</section>
<section id="three-kinds-of-data">
<h2>Three kinds of data<a class="headerlink" href="#three-kinds-of-data" title="Link to this heading"></a></h2>
<p>Vlasiator produces three kinds of output files during a simulation run,
the contents of which vary based on simulation parameters:</p>
<p>1. <code class="docutils literal notranslate"><span class="pre">logfile.txt</span></code>, the simulation run log. This is a timestamped ascii
file providing basic diagnostic output of the run, including memory
usage, time steps, counts of spatial cells at refinement levels etc.</p>
<p>2. <code class="docutils literal notranslate"><span class="pre">diagnostic.txt</span></code>. The contents of this file
can be configured by the <code class="docutils literal notranslate"><span class="pre">diagnostic</span> <span class="pre">=</span></code> options in the run config
file. In general, this ascii file will contain one line per (1, 10, or
so) simulation timesteps, with the columns determined by the selected
data reducers. These include, for example, simple scalar values like
overall plasma mass, number of velocity space blocks in the simulation,
maximum time step allowed by each solver, mass loss due to sparsity etc.</p>
<p>3. <strong>VLSV files</strong> are
the main output data products. These files come in multiple varieties:</p>
<p>* Restart files. These checkpoint contain the whole simulation state, including
the full phase space density, all relevant electromagnetic fields and
metadata. Simulations can be restarted from them (hence the name), but
they tend to be very heavy, easily multiple terabytes in size for
production runs. They do not contain the output of data reducer
operators (detailed below).</p>
<p>* Bulk files. In these, reduced spatial
simulation data is written for further scientific analysis. Usually,
this includes moments of the distribution functions and electromagnetic
fields, but can also contain much more complex data reducer operators,
as listed below. It is also possible (and common) to configure a subset
(e.g. every 25th cell) of the velocity distribution functions to be
written for further analysis.</p>
<p>N.b. saving FSgrid variables for large 3D runs can lead to significant
disk space usage, due to the FSgrid being uniform at the highest resolution
setting. For this reason, storing FSgrid variables in bulk files should
be carefully considered. It is also possible to declare several different
bulk file settings, one of which can be defined to exclude FSgrid variables
and be output more often, with the FSgrid-variable including version output
only e.g. every 10 seconds.</p>
</section>
<section id="the-vlsv-file-format">
<h2>The VLSV file format<a class="headerlink" href="#the-vlsv-file-format" title="Link to this heading"></a></h2>
<p>The <a class="reference external" href="https://github.com/fmihpc/vlsv">VLSV library</a> is used to write
this versatile container format.
<a class="reference external" href="https://github.com/fmihpc/analysator">Analysator</a> can be used to
load and handle these files in python.</p>
<p>The file format is optimized for parallel write performance: Data is
dumped to disk in the same memory structure as it is in the Vlasiator
simulation, as binary blobs. Once all data is written, an XML footer
that describes the data gets added to the end.</p>
<p>An example XML footer might look like this:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;VLSV&gt;</span>
<span class="w">   </span><span class="nt">&lt;MESH</span><span class="w"> </span><span class="na">arraysize=</span><span class="s">&quot;208101&quot;</span><span class="w"> </span><span class="na">datasize=</span><span class="s">&quot;8&quot;</span><span class="w"> </span><span class="na">datatype=</span><span class="s">&quot;uint&quot;</span><span class="w"> </span><span class="na">max_refinement_level=</span><span class="s">&quot;1&quot;</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;SpatialGrid&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;amr_ucd&quot;</span><span class="w"> </span><span class="na">vectorsize=</span><span class="s">&quot;1&quot;</span><span class="w"> </span><span class="na">xperiodic=</span><span class="s">&quot;no&quot;</span><span class="w"> </span><span class="na">yperiodic=</span><span class="s">&quot;no&quot;</span><span class="w"> </span><span class="na">zperiodic=</span><span class="s">&quot;no&quot;</span><span class="nt">&gt;</span>989580<span class="nt">&lt;/MESH&gt;</span>
<span class="w">   </span><span class="nt">&lt;MESH</span><span class="w"> </span><span class="na">arraysize=</span><span class="s">&quot;652800&quot;</span><span class="w"> </span><span class="na">datasize=</span><span class="s">&quot;8&quot;</span><span class="w"> </span><span class="na">datatype=</span><span class="s">&quot;uint&quot;</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;fsgrid&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;multi_ucd&quot;</span><span class="w"> </span><span class="na">vectorsize=</span><span class="s">&quot;1&quot;</span><span class="w"> </span><span class="na">xperiodic=</span><span class="s">&quot;no&quot;</span><span class="w"> </span><span class="na">yperiodic=</span><span class="s">&quot;no&quot;</span><span class="w"> </span><span class="na">zperiodic=</span><span class="s">&quot;no&quot;</span><span class="nt">&gt;</span>4011008<span class="nt">&lt;/MESH&gt;</span>
<span class="w">   </span><span class="nt">&lt;PARAMETER</span><span class="w"> </span><span class="na">arraysize=</span><span class="s">&quot;1&quot;</span><span class="w"> </span><span class="na">datasize=</span><span class="s">&quot;8&quot;</span><span class="w"> </span><span class="na">datatype=</span><span class="s">&quot;float&quot;</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;time&quot;</span><span class="w"> </span><span class="na">vectorsize=</span><span class="s">&quot;1&quot;</span><span class="nt">&gt;</span>989488<span class="nt">&lt;/PARAMETER&gt;</span>
<span class="w">   </span><span class="nt">&lt;PARAMETER</span><span class="w"> </span><span class="na">arraysize=</span><span class="s">&quot;1&quot;</span><span class="w"> </span><span class="na">datasize=</span><span class="s">&quot;8&quot;</span><span class="w"> </span><span class="na">datatype=</span><span class="s">&quot;float&quot;</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;dt&quot;</span><span class="w"> </span><span class="na">vectorsize=</span><span class="s">&quot;1&quot;</span><span class="nt">&gt;</span>989496<span class="nt">&lt;/PARAMETER&gt;</span>
<span class="w">   </span><span class="nt">&lt;VARIABLE</span><span class="w"> </span><span class="na">arraysize=</span><span class="s">&quot;123544&quot;</span><span class="w"> </span><span class="na">datasize=</span><span class="s">&quot;8&quot;</span><span class="w"> </span><span class="na">datatype=</span><span class="s">&quot;uint&quot;</span><span class="w"> </span><span class="na">mesh=</span><span class="s">&quot;SpatialGrid&quot;</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;CellID&quot;</span><span class="w"> </span><span class="na">vectorsize=</span><span class="s">&quot;1&quot;</span><span class="nt">&gt;</span>1136<span class="nt">&lt;/VARIABLE&gt;</span>
<span class="w">   </span><span class="nt">&lt;VARIABLE</span><span class="w"> </span><span class="na">arraysize=</span><span class="s">&quot;652800&quot;</span><span class="w"> </span><span class="na">datasize=</span><span class="s">&quot;8&quot;</span><span class="w"> </span><span class="na">datatype=</span><span class="s">&quot;float&quot;</span><span class="w"> </span><span class="na">mesh=</span><span class="s">&quot;fsgrid&quot;</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;fg_b&quot;</span><span class="w"> </span><span class="na">unit=</span><span class="s">&quot;T&quot;</span><span class="w"> </span><span class="na">unitConversion=</span><span class="s">&quot;1.0&quot;</span><span class="w"> </span><span class="na">unitLaTeX=</span><span class="s">&quot;$\mathrm{T}$&quot;</span><span class="w"> </span><span class="na">variableLaTeX=</span><span class="s">&quot;$B$&quot;</span><span class="w"> </span><span class="na">vectorsize=</span><span class="s">&quot;3&quot;</span><span class="nt">&gt;</span>9558184<span class="nt">&lt;/VARIABLE&gt;</span>
<span class="nt">&lt;/VLSV&gt;</span>
</pre></div>
</div>
<p>Each XML tag describes one dataset in the file, with <code class="docutils literal notranslate"><span class="pre">arraysize</span></code>,
<code class="docutils literal notranslate"><span class="pre">datatype</span></code>, <code class="docutils literal notranslate"><span class="pre">datasize</span></code> and <code class="docutils literal notranslate"><span class="pre">vectorsize</span></code> describing the array. The
XML tag’s content contains the byte offset in the file, where this
dataset’s raw binary data lies.</p>
<p>The two most important tag types are <code class="docutils literal notranslate"><span class="pre">PARAMETER</span></code>, for single numbers
describing the file as a whole, such as resolutions, timesteps etc., and
<code class="docutils literal notranslate"><span class="pre">VARIABLE</span></code>, for spatially varying data reducer data maps.</p>
<p>Additional metadata is often added to the datasets, such as their
physical units, LaTeX formatted plotting hints, etc.</p>
<p>It can sometimes be useful to use the command line to look directly at
the XML footer information which contains information on all variables
included in the file, e.g. <code class="docutils literal notranslate"><span class="pre">tail</span> <span class="pre">-n</span> <span class="pre">60</span> <span class="pre">bulk.0001234.vlsv</span> <span class="pre">|less</span></code>. You
can adjust the line count until you have the information you need.
Adding too many lines will result in human-unreadable binary output.</p>
</section>
<section id="spatial-ordering-vlasov-vs-fsgrid-vs-velocity-space-variables">
<h2>Spatial ordering: Vlasov- vs. FSGrid vs. Velocity space variables<a class="headerlink" href="#spatial-ordering-vlasov-vs-fsgrid-vs-velocity-space-variables" title="Link to this heading"></a></h2>
<p>Note that the XML tags in the file do not yet give sufficient
information to describe the spatial structure of the variable arrays.
The construction differs depending on the grid they are linked to
(denoted by the <code class="docutils literal notranslate"><span class="pre">mesh=</span></code> attribute):</p>
<ul>
<li><p><strong>Vlasov grid variables</strong>,
typically marked with a <code class="docutils literal notranslate"><span class="pre">vg_</span></code> in their name, are stored as cell
parameters in the <a class="reference external" href="https://github.com/fmihpc/dccrg">DCCRG</a> grid
underlying the vlasov solver. As the simulation is dynamically load
balanced, their memory order changes unpredictably, so the data must be
presumed completely unordered in the file.</p>
<p>Fortunately, the <code class="docutils literal notranslate"><span class="pre">CellID</span></code> variable gets written into the file first,
which contains the flattened spatial index of the given simulation cells
in the same order as all further Vlasov grid variables. In the simplest,
non mesh-refined version, the CellID is defined as</p>
<p><code class="docutils literal notranslate"><span class="pre">CellID</span> <span class="pre">=</span> <span class="pre">x_index</span> <span class="pre">+</span> <span class="pre">x_size</span> <span class="pre">*</span> <span class="pre">y_index</span> <span class="pre">+</span> <span class="pre">x_size</span> <span class="pre">*</span> <span class="pre">y_size</span> <span class="pre">*</span> <span class="pre">z_index</span> <span class="pre">+</span> <span class="pre">1</span></code></p>
<p>By reading both the intended target variable and the CellID, the data
can thus be brought into flattened spatial order by simply sorting both
arrays in the same order. In analysator, this is typically achieved by
running</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">c</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">read_variable</span><span class="p">(</span><span class="s2">&quot;CellID&quot;</span><span class="p">)</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">read_variable</span><span class="p">(</span><span class="s2">&quot;rho&quot;</span><span class="p">)</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">b</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">c</span><span class="p">)]</span>
<span class="n">b</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">get_spatial_mesh_size</span><span class="p">())</span>
</pre></div>
</div>
</li>
<li><p><strong>FSGrid variables</strong> are stored on the simulations <a class="reference external" href="https://github.com/fmihpc/fsgrid">fieldsolver
grid</a>, which is partitioned
quite differently for performance reasons. The spatial domain is
subdivided into equally sized rectangular domains, which are written
for each compute rank in parallel. If written from a simulation with
a single MPI rank, the resulting array is directly ordered in spatial
order, as by the cellID definition above. For simulations on multiple
ranks, every rank writes its data in this structure, end-to-end. The
<code class="docutils literal notranslate"><span class="pre">num_writing_ranks</span></code> and the <code class="docutils literal notranslate"><span class="pre">MESH_DECOMPOSITION</span></code> arguments in the
XML tag allow the spatial partition to be reconstructed on load time.</p></li>
<li><p><strong>Ionospheric grid variables</strong> are stored on the simulations <cite>ionosphere
grid</cite>, which is a statically refined triangular mesh designed for solving
ionospheric potentials.</p></li>
<li><p><strong>Velocity space variables</strong> (at the moment, this is only the phase
space density f for every species), follow yet another structure due
to the sparse velocity grid structure on which they are stored.</p></li>
</ul>
</section>
<section id="simulation-data-reducers">
<h2>Simulation data reducers<a class="headerlink" href="#simulation-data-reducers" title="Link to this heading"></a></h2>
<p>This is a (mostly) up-to date list of simulation output options
that can be enabled in the config file. Note that older simulation
possibly use slightly different names, as the code is in constant
development.</p>
<table class="docutils align-default" id="id1">
<caption><span class="caption-text">Vlasiator outputs</span><a class="headerlink" href="#id1" title="Link to this table"></a></caption>
<colgroup>
<col style="width: 19.0%" />
<col style="width: 19.0%" />
<col style="width: 4.8%" />
<col style="width: 38.1%" />
<col style="width: 19.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Variable name</p></th>
<th class="head"><p>config option</p></th>
<th class="head"><p>unit</p></th>
<th class="head"><p>meaning</p></th>
<th class="head"><p>literature ref</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>CellID</p></td>
<td><p>always written</p></td>
<td><p>cells</p></td>
<td><p>Spatial ordering of vlasov grid cells</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>fg_b</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">fg_b</span></code></p></td>
<td><p>T</p></td>
<td><p>Overall magnetic field (vector)</p></td>
<td><p>[Palmroth et al. 2018](<a class="reference external" href="https://link.springer.com/article/10.1007%2Fs41115-018-0003-2">https://link.springer.com/article/10.1007%2Fs41115-018-0003-2</a>)</p></td>
</tr>
<tr class="row-even"><td><p>fg_b_background</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">fg_backgroundb</span></code></p></td>
<td><p>T</p></td>
<td><p>Static background magnetic field (i.e. dipole field in a magnetosphere simulation. Vector.)</p></td>
<td><p>[Palmroth et al. 2018](<a class="reference external" href="https://link.springer.com/article/10.1007%2Fs41115-018-0003-2">https://link.springer.com/article/10.1007%2Fs41115-018-0003-2</a>)</p></td>
</tr>
<tr class="row-odd"><td><p>fg_b_perturbed</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">fg_perturbedb</span></code></p></td>
<td><p>T</p></td>
<td><p>Fluctuating component of the magnetic field (vector)</p></td>
<td><p>[Palmroth et al. 2018](<a class="reference external" href="https://link.springer.com/article/10.1007%2Fs41115-018-0003-2">https://link.springer.com/article/10.1007%2Fs41115-018-0003-2</a>)</p></td>
</tr>
<tr class="row-even"><td><p>fg_e</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">fg_e</span></code></p></td>
<td><p>V/m</p></td>
<td><p>Electric field calculated as ∇ × B (Vector)</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>vg_rhom</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">vg_rhom</span></code></p></td>
<td><p>kg/m³</p></td>
<td><p>combined mass density of all simulation species</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>fg_rhom</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">fg_rhom</span></code></p></td>
<td><p>kg/m³</p></td>
<td><p>-‘’-</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>vg_rhoq</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">vg_rhoq</span></code></p></td>
<td><p>C/m³</p></td>
<td><p>combined charge density of all simulation species</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>fg_rhoq</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">fg_rhoq</span></code></p></td>
<td><p>C/m³</p></td>
<td><p>-‘’-</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>proton_vg_rho</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">populations_rho</span></code></p></td>
<td><p>1/m³</p></td>
<td><p>Number density for each simulated particle population</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>vg_v</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">vg_v</span></code></p></td>
<td><p>m/s</p></td>
<td><p>Bulk plasma velocity (velocity of the centre-of-mass frame vector)</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>fg_v</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">fg_v</span></code></p></td>
<td><p>m/s</p></td>
<td><p>-‘’-</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>proton_vg_v</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">populations_v</span></code></p></td>
<td><p>m/s</p></td>
<td><p>Per-population bulk velocity</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>proton_vg_rho_thermal</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">populations_moments_thermal</span></code></p></td>
<td><p>1/m³</p></td>
<td><p>Number density for the <strong>thermal</strong> component of every population</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>proton_vg_v_thermal</p></td>
<td><p>-‘’-</p></td>
<td><p>m/s</p></td>
<td><p>Velocity (vector) for the <strong>thermal</strong> component of every population</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>proton_vg_ptensor_diagonal_thermal</p></td>
<td><p>-‘’-</p></td>
<td><p>Pa</p></td>
<td><p>Diagonal components of the pressure tensor for the <strong>thermal</strong> component of every population</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>proton_vg_ptensor_offdiagonal_thermal</p></td>
<td><p>-‘’-</p></td>
<td><p>Pa</p></td>
<td><p>Off-Diagonal components of the pressure tensor for the <strong>thermal</strong> component of every population</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>proton_vg_rho_nonthermal</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">populations_moments_nonthermal</span></code></p></td>
<td><p>1/m³</p></td>
<td><p>Number density for the <strong>nonthermal</strong> component of every population</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>proton_vg_v_nonthermal</p></td>
<td><p>-‘’-</p></td>
<td><p>m/s</p></td>
<td><p>Velocity (vector) for the <strong>nonthermal</strong> component of every population</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>proton_vg_ptensor_diagonal_nonthermal</p></td>
<td><p>-‘’-</p></td>
<td><p>Pa</p></td>
<td><p>Diagonal components of the pressure tensor for the <strong>nonthermal</strong> component of every population</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>proton_vg_ptensor_offdiagonal_nonthermal</p></td>
<td><p>-‘’-</p></td>
<td><p>Pa</p></td>
<td><p>Off-Diagonal components of the pressure tensor for the <strong>nonthermal</strong> component of every population</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>proton_minvalue</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">populations_vg_effectivesparsitythreshold</span></code></p></td>
<td><p>m^6/s³</p></td>
<td><p>Effective sparsity threshold for every cell.</p></td>
<td><p>[Yann’s PhD Thesis](<a class="reference external" href="http://urn.fi/URN:ISBN:978-952-336-001-3">http://urn.fi/URN:ISBN:978-952-336-001-3</a>) page 91</p></td>
</tr>
<tr class="row-even"><td><p>proton_rholossadjust</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">populations_vg_rho_loss_adjust</span></code></p></td>
<td><p>1/m³</p></td>
<td><p>Tracks how much mass was lost in the sparse velocity space block removal</p></td>
<td><p>[Yann’s PhD Thesis](<a class="reference external" href="http://urn.fi/URN:ISBN:978-952-336-001-3">http://urn.fi/URN:ISBN:978-952-336-001-3</a>) page 90</p></td>
</tr>
<tr class="row-odd"><td><p>vg_lbweight</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">vg_lbweight</span></code></p></td>
<td><p>arb. unit</p></td>
<td><p>Load balance metric</p></td>
<td><p>used for dynamic rebalancing of computational load between mpi tasks</p></td>
</tr>
<tr class="row-even"><td><p>vg_maxdt_acceleration</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">vg_maxdt_acceleration</span></code></p></td>
<td><p>s</p></td>
<td><p>Maximum timestep limit of the acceleration solver</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>proton_vg_maxdt_acceleration</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">populations_vg_maxdt_acceleration</span></code></p></td>
<td><p>s</p></td>
<td><p>-‘’-</p></td>
<td><p>per-population</p></td>
</tr>
<tr class="row-even"><td><p>vg_maxdt_translation</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">vg_maxdt_translation</span></code></p></td>
<td><p>s</p></td>
<td><p>Maximum timestep limit of the translation solver</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>proton_vg_maxdt_translation</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">populations_vg_maxdt_translation</span></code></p></td>
<td><p>s</p></td>
<td><p>-‘’-</p></td>
<td><p>per-population</p></td>
</tr>
</tbody>
</table>
</section>
<section id="vlsv-data-tools">
<h2>VLSV data tools<a class="headerlink" href="#vlsv-data-tools" title="Link to this heading"></a></h2>
<p>A short note on the included tools, compiled by:</p>
<p><code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">vlsvextract</span> <span class="pre">vlsvdiff</span></code></p>
<p>Some older tools included in <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">tools</span></code> are not currently supported.</p>
<section id="vlsvextract">
<h3>vlsvextract<a class="headerlink" href="#vlsvextract" title="Link to this heading"></a></h3>
<p><code class="docutils literal notranslate"><span class="pre">vlsvextract</span></code> can be used to extract VDF data from vlsv files and store it as a separate VLSV file for visualization.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span> <span class="n">USAGE</span><span class="p">:</span> <span class="o">./</span><span class="n">vlsvextract_DP</span> <span class="o">&lt;</span><span class="n">file</span> <span class="n">name</span> <span class="n">mask</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">options</span><span class="o">&gt;</span>

 <span class="n">To</span> <span class="n">get</span> <span class="n">a</span> <span class="nb">list</span> <span class="n">of</span> <span class="n">options</span> <span class="n">use</span> <span class="o">--</span><span class="n">help</span>

 <span class="n">Options</span><span class="p">:</span>
<span class="o">--</span><span class="n">help</span>                <span class="n">display</span> <span class="n">help</span>
<span class="o">--</span><span class="n">debug</span>               <span class="n">write</span> <span class="n">debugging</span> <span class="n">info</span> <span class="n">to</span> <span class="n">stderr</span>
<span class="o">--</span><span class="n">cellid</span> <span class="n">arg</span>          <span class="n">Set</span> <span class="n">cell</span> <span class="nb">id</span>
<span class="o">--</span><span class="n">cellidlist</span> <span class="n">arg</span>      <span class="n">Set</span> <span class="nb">list</span> <span class="n">of</span> <span class="n">cell</span> <span class="n">ids</span>
<span class="o">--</span><span class="n">rotate</span>              <span class="n">Rotate</span> <span class="n">velocities</span> <span class="n">so</span> <span class="n">that</span> <span class="n">they</span> <span class="n">face</span> <span class="n">z</span><span class="o">-</span><span class="n">axis</span>
<span class="o">--</span><span class="n">plasmaFrame</span>         <span class="n">Shift</span> <span class="n">the</span> <span class="n">distribution</span> <span class="n">so</span> <span class="n">that</span> <span class="n">the</span> <span class="n">bulk</span> <span class="n">velocity</span> <span class="ow">is</span> <span class="mi">0</span>
<span class="o">--</span><span class="n">coordinates</span> <span class="n">arg</span>     <span class="n">Set</span> <span class="n">spatial</span> <span class="n">coordinates</span> <span class="n">x</span> <span class="n">y</span> <span class="n">z</span>
<span class="o">--</span><span class="n">unit</span> <span class="n">arg</span>            <span class="n">Sets</span> <span class="n">the</span> <span class="n">units</span><span class="o">.</span> <span class="n">Options</span><span class="p">:</span> <span class="n">re</span><span class="p">,</span> <span class="n">km</span><span class="p">,</span> <span class="n">m</span> <span class="p">(</span><span class="n">OPTIONAL</span><span class="p">)</span>
<span class="o">--</span><span class="n">point1</span> <span class="n">arg</span>          <span class="n">Set</span> <span class="n">the</span> <span class="n">starting</span> <span class="n">point</span> <span class="n">x</span> <span class="n">y</span> <span class="n">z</span> <span class="n">of</span> <span class="n">a</span> <span class="n">line</span>
<span class="o">--</span><span class="n">point2</span> <span class="n">arg</span>          <span class="n">Set</span> <span class="n">the</span> <span class="n">ending</span> <span class="n">point</span> <span class="n">x</span> <span class="n">y</span> <span class="n">z</span> <span class="n">of</span> <span class="n">a</span> <span class="n">line</span>
<span class="o">--</span><span class="n">pointamount</span> <span class="n">arg</span>     <span class="n">Number</span> <span class="n">of</span> <span class="n">points</span> <span class="n">along</span> <span class="n">a</span> <span class="n">line</span> <span class="p">(</span><span class="n">OPTIONAL</span><span class="p">)</span>
<span class="o">--</span><span class="n">outputdirectory</span> <span class="n">arg</span> <span class="n">The</span> <span class="n">directory</span> <span class="n">where</span> <span class="n">the</span> <span class="n">file</span> <span class="ow">is</span> <span class="n">saved</span> <span class="p">(</span><span class="n">default</span> <span class="n">current</span> <span class="n">folder</span><span class="p">)</span> <span class="p">(</span><span class="n">OPTIONAL</span><span class="p">)</span>
</pre></div>
</div>
<p>For example, let’s pick a VDF from the foreshock of the Mercury 5D example run; see VisIt lecture one method on how we can find the cellID, here we have a cellID pre-picked.</p>
<p><code class="docutils literal notranslate"><span class="pre">./vlsvextract_DP</span> <span class="pre">/scratch/project_465000693/example_runs/Mercury5D/bulk/bulk.0000122.vlsv</span> <span class="pre">--cellid</span> <span class="pre">332776</span></code></p>
<p>This can be used to extract VDFs over lines and multiple files as well.</p>
</section>
<section id="vlsvdiff">
<h3>vlsvdiff<a class="headerlink" href="#vlsvdiff" title="Link to this heading"></a></h3>
<p><code class="docutils literal notranslate"><span class="pre">vlsvdiff</span></code> we use for e.g. continuous integration testing. There is an included testpackage, from which one can generate reference data and compare the effects of one’s code edits locally.</p>
<p>Other use is to extract differences between different files - for example, time differences.</p>
</section>
</section>
<section id="other-output-files">
<h2>Other output files<a class="headerlink" href="#other-output-files" title="Link to this heading"></a></h2>
<p>If the PHIPROF profiler suite is in use, you will also see e.g. <code class="docutils literal notranslate"><span class="pre">phiprof_0.txt</span></code> in the run directory,
providing rough ASCII tables of run-time timers, useful for rudimentary profiling of the Vlasiator
code, solvers, and I/O.</p>
</section>
<section id="interesting-questions-you-might-get">
<h2>Interesting questions you might get<a class="headerlink" href="#interesting-questions-you-might-get" title="Link to this heading"></a></h2>
<p>Q: Why are the output formats so convoluted?</p>
<p>A: They are optimized for run-time performance, so that each MPI task can simply pour its data into
one contiguous region on-disk via MPI writes.</p>
</section>
<section id="typical-pitfalls">
<h2>Typical pitfalls<a class="headerlink" href="#typical-pitfalls" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p>Read Vlasov grid data and forget the order the cells based on CELLIDS</p></li>
<li><p>Read FSGrid data and accidentally order that also according to CELLIDS</p></li>
</ul>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../benchmarks_and_running/" class="btn btn-neutral float-left" title="How to configure Vlasiator for performance" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../visit/" class="btn btn-neutral float-right" title="VisIt and VLSV bootcamp" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, The contributors.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>